{"version":3,"file":"inputAndDatePicker.cd2257ae.js","sources":["../src/components/TableInfo/fieldFile/inputAndDatePicker.tsx"],"sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\nimport styled from 'styled-components';\n\nimport {connect} from \"dva\";\nimport {DatePicker as ADatePicker, Input as AInput} from 'antd';\nimport type {Iconf} from '../TableInfo';\nimport {wrapContext} from '../TableInfo';\nimport {ShowData} from './_css_comm';\nimport moment from 'moment';\nimport {Form} from 'antd';\nimport {useList} from \"react-use\";\n\n\nconst InputDatePicker = styled.div`\n  .ant-form-item-control-input-content {\n    display: flex;\n\n    .ant-input-number {\n      width: 48%;\n      flex: 1;\n    }\n\n    .ant-divider {\n      min-width: 40px;\n      width: 40px;\n    }\n  }\n\n  .box {\n    display: flex;\n    width: 100%;\n\n    .box-right-side-box {\n      flex: 7;\n\n      .ant-space-item {\n        flex: 1;\n\n        &:nth-child(2) {\n          flex: 0;\n          width: 20px;\n        }\n\n        .ant-divider-horizontal {\n          width: 20px;\n        }\n      }\n    }\n  }\n`;\n\nconst Minput = styled(AInput)`\n  && {\n    height: 100%;\n    padding: 1vh;\n  }\n`;\nconst MDatePicker = styled<any>(ADatePicker)`\n  width: 100%;\n\n  && {\n    padding: 1vh;\n  }\n`;\n\nconst Label = styled.div<{ col?: string | number; style?: Record<string, any> | undefined }>`\n  flex: ${(props) => (props.col ? props.col : 3)};\n  position: relative;\n  /* ::after{\n    content:\"*\";\n    position: absolute;\n    left:0;\n    top:0;\n    color:red;\n  } */\n`;\n\n\ninterface IconfInput extends Iconf {\n  placeholder?: string;\n  disabledDate?: object | string;\n  disabledTime?: object | string;\n  showTime?: boolean;\n}\n\ninterface Iinput {\n  dispatch?: any;\n  conf: IconfInput;\n  name: string;\n  rules: any;\n}\n\nconst InputAndDatePicker: React.FC<Iinput> = (props) => {\n  const _: any = props.conf;\n  const theme: any = useContext(wrapContext);\n\n\n  const getBirthday = (value) => {\n    if (value.length === 18) {\n      // 18位身份证号\n      let birthday = value.substr(6, 4) + \"-\" + value.substr(10, 2) + \"-\" + value.substr(12, 2);\n      theme.form.setFieldsValue({\n        [_.datePickerProps.name]: moment(birthday, 'YYYY/MM/DD')\n      });\n    } else if (value.length === 15) {\n      // 15位身份证号\n      let birthday = \"19\" + value.substr(6, 2) + \"-\" + value.substr(8, 2) + \"-\" + value.substr(10, 2);\n      theme.form.setFieldsValue({\n        [_.datePickerProps.name]: moment(birthday, 'YYYY/MM/DD'),\n      });\n    }\n  }\n\n  return (\n    <wrapContext.Consumer>\n      {(_data): any => {\n        switch (_data.state) {\n          case 'default':\n            return <ShowData>{_.defaultValue || '　'}</ShowData>;\n            break;\n          case 'edit':\n          case 'new':\n          case 'disabled':\n            return (\n              <InputDatePicker style={{display: \"flex\"}}>\n                <div className=\"box\">\n                  <Label\n                    style={{\n                      width: '100%'\n                    }}\n                    col={3}\n                    className=\"contentItem-name\"\n                  >\n                    <span className=\"required\">*</span>\n                    {_.inputProps.label}\n                  </Label>\n                  <div className=\"box-right-side-box\">\n                    <Form.Item name={_.inputProps.name} rules={props.rules}>\n                      <Minput\n                        style={_.inputProps.style}\n                        disabled={_data.state === 'disabled'}\n                        placeholder={_.inputProps.placeholder}\n                        size={_.inputProps.size}\n                        onBlur={(e) => {\n                          console.log(e.target.value)\n                          getBirthday(e.target.value);\n\n                        }}\n                      />\n                    </Form.Item>\n                  </div>\n                </div>\n                <div className=\"box\">\n                  <Label\n                    style={{\n                      width: '100%'\n                    }}\n                    col={3}\n                    className=\"contentItem-name\"\n                  >\n                    {_.datePickerProps.label}\n                  </Label>\n                  <div className=\"box-right-side-box\">\n                    <Form.Item name={_.datePickerProps.name} rules={props.rules}>\n                      <MDatePicker\n                        style={_.datePickerProps.style}\n                        showTime={_.datePickerProps.showTime}\n                        disabledDate={(current: number) => {\n                          if (typeof _.datePickerProps.disabledDate === 'function') {\n                            return _.disabledDate(current);\n                          }\n                          if (_.datePickerProps.disabledDate === '>') {\n                            return current && current > Number(moment().endOf('day').subtract(1, 'days'));\n                          }\n                          if (_.datePickerProps.disabledDate === '<') {\n                            return current && current < Number(moment().endOf('day').subtract(1, 'days'));\n                          }\n                        }}\n                        disabledTime={_.datePickerProps.showTime && _.datePickerProps.disabledTime ? _.datePickerProps.disabledTime : null}\n                        disabled={_data.state === 'disabled'}\n                        format={_.datePickerProps.showTime ? 'YYYY/MM/DD HH:mm:ss' : 'YYYY/MM/DD'}\n                      />\n                    </Form.Item>\n                  </div>\n                </div>\n              </InputDatePicker>\n            );\n            break;\n        }\n      }}\n    </wrapContext.Consumer>\n  );\n};\nexport default connect(({}) => ({}))(InputAndDatePicker);\n"],"names":["InputDatePicker","styled","Minput","AInput","MDatePicker","ADatePicker","Label","props","InputAndDatePicker","_","theme","useContext","wrapContext","getBirthday","value","birthday","moment","React","_data","ShowData","Form","e","current"],"mappings":"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"}
var Ce=Object.defineProperty,Fe=Object.defineProperties;var we=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var K=(i,u,s)=>u in i?Ce(i,u,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[u]=s,n=(i,u)=>{for(var s in u||(u={}))_e.call(u,s)&&K(i,s,u[s]);if(H)for(var s of H(u))xe.call(u,s)&&K(i,s,u[s]);return i},d=(i,u)=>Fe(i,we(u));var A=(i,u,s)=>new Promise((b,E)=>{var D=y=>{try{k(s.next(y))}catch(C){E(C)}},x=y=>{try{k(s.throw(y))}catch(C){E(C)}},k=y=>y.done?b(y.value):Promise.resolve(y.value).then(D,x);k((s=s.apply(i,u)).next())});import{R as t,c as ke,_ as m,B as I,bQ as Be}from"./index.353dd2ef.js";import{u as Se}from"./index.981931b8.js";import{I as v,A as Q,a as V}from"./index.4897d79a.js";import{F as h}from"./index.66f418cc.js";import{T,S as z,a as ve}from"./Table.84915985.js";import{S as Ne}from"./index.698de9d8.js";import{M as S}from"./index.9307a5cf.js";import{_ as Re}from"./index.1af7b029.js";import{D as qe}from"./index.713bae6c.js";import{P as J}from"./PlusCircleOutlined.c71d6d7a.js";import{D as Ae}from"./DeleteOutlined.a973045b.js";import"./Pagination.79d24ff3.js";import"./index.adfb1e41.js";const f={url:"/data-acquisition/role-info",params:{},checkBox:!0,operation:[{name:"\u67E5\u770B\u7528\u6237",type:"disabled",drawerWidth:"50"},{name:"\u7F16\u8F91",type:"disabled",drawerWidth:"50"},{name:"\u5220\u9664",type:"disabled",drawerWidth:"50"}],userOperation:[{name:"\u7F16\u8F91",type:"disabled",drawerWidth:"50"},{name:"\u5220\u9664",type:"disabled",drawerWidth:"50"}],searchListType:"multipleQuery",searchList:[{title:"\u5173\u952E\u5B57",type:"input",key:"name",placeholder:"\u8BF7\u8F93\u5165"}],tableColumns:(i,u,s)=>(u.pagination.current,u.pagination.pageSize,[{title:"\u89D2\u8272\u540D\u79F0",key:"roleName",dataIndex:"roleName",width:"10%",align:"center"},{title:"\u5B9E\u9645\u6210\u5458",width:"10%",align:"center",render:(b,E,D)=>E.userInfo.length+"\u4EBA"},{title:"\u9875\u9762\u6743\u9650",width:"10%",align:"center",render:(b,E,D)=>E.pageAuthority.typeName},{title:"\u64CD\u4F5C\u6743\u9650",width:"10%",align:"center",render:(b,E,D)=>E.operationAuthority.typeName},{title:"\u89D2\u8272\u6743\u9650",key:"jurisdictionDeadline",dataIndex:"jurisdictionDeadline",width:"10%",align:"center"}]),userTableColumns:[{title:"\u7528\u6237\u540D",key:"username",dataIndex:"username",width:"8%",align:"center"},{title:"\u624B\u673A\u53F7",key:"phone",dataIndex:"phone",width:"10%",align:"center"},{title:"\u5BC6\u7801",key:"password",dataIndex:"password",width:"8%",align:"center",render:(i,u,s)=>t.createElement(v.Password,{bordered:!1,value:i,placeholder:"input password"})}]},Ie="style-module__jurisdictionManage___5gWwL",Te="style-module__search___GvQ-G",je="style-module__left___CN0uS";var c={jurisdictionManage:Ie,search:Te,left:je,"m-box":"style-module__m-box___XEvjx","mb-row2":"style-module__mb-row2___c7Yyy","mbr-left":"style-module__mbr-left___-iuYl","mbr-right":"style-module__mbr-right___ejzpZ","mb-biaoshi":"style-module__mb-biaoshi___SVBdC"};const{Option:Me}=Q,{Column:_}=T,Oe=i=>{var P;const{dispatch:u,select:s}=i,[b]=h.useForm(),[E,D]=m.exports.useState({}),[x,k]=m.exports.useState([]),[y,C]=m.exports.useState([]),[X,j]=m.exports.useState(""),[Z,N]=m.exports.useState(!1),[o,g]=m.exports.useState({}),[$,ee]=m.exports.useState([]),[te,M]=m.exports.useState(""),[ae,B]=m.exports.useState(!1),[p,F]=m.exports.useState({}),[ue,le]=m.exports.useState([]),[Ye,re]=m.exports.useState(""),[oe,O]=m.exports.useState(!1),ne=({current:e,pageSize:a},l)=>new Promise(r=>{u({type:"common/getRequestData",method:"GET",url:f.url,payload:n({pageNo:e,pageSize:a,rbacToken:"7ed6a62261854a4eb27d844ff4df1885"},l),callback:w=>{if(w.success){let De=w.data.list,be=w.data.total;r({list:De,total:be})}}})}),{tableProps:Y,search:se}=Se(ne,{defaultPageSize:10,form:b}),{submit:Ue,reset:R}=se,U=()=>{u({type:"common/getRequestData",method:"GET",url:"/data-acquisition/role-info/list",payload:{},callback:e=>{e.success&&ee(e.data)}})},L=()=>new Promise(e=>{u({type:"common/getRequestData",method:"GET",url:"/data-acquisition/menu-info",payload:{},callback:a=>{if(a.success){const l=a.data[0],r=JSON.parse(l.menuJson);W(r,0,[]),e(r)}}})}),W=(e,a,l)=>{Array.isArray(e)&&e.map((r,w)=>{r.key=r.id,r.value=r.id,r.title=r.displayName,a===0&&a+w===0&&l.push(r.id),Array.isArray(r.children)&&r.children.length&&W(r.children,a+w,l)})},ie=()=>A(void 0,null,function*(){let e=yield L();C(e),g({}),j("\u65B0\u589E\u89D2\u8272"),N(!0)}),ce=e=>A(void 0,null,function*(){let a=yield L();C(a),u({type:"common/getRequestData",method:"GET",url:"/data-acquisition/role-info/"+e,payload:{},callback:l=>{if(l.success){const r=l.data;g(d(n({},r),{pageAuthority:JSON.parse(r.pageAuthority),jurisdictionDeadline:r.jurisdictionDeadline?Be(r.jurisdictionDeadline,"YYYY-MM-DD HH:mm:SS"):""})),j("\u7F16\u8F91\u89D2\u8272"),N(!0)}}})}),de=e=>{S.confirm({title:"\u5220\u9664",icon:"",content:"\u786E\u5B9A\u8981\u5220\u9664\u5F53\u524D\u89D2\u8272\u5417",onOk(){u({type:"common/getRequestData",method:"delete",url:"/data-acquisition/role-info/"+e,payload:{},callback:a=>{a.success&&R()}})},onCancel(){console.log("Cancel")}})},me=()=>{console.log(x),S.confirm({title:"\u5220\u9664",icon:"",content:"\u786E\u5B9A\u8981\u5220\u9664\u5F53\u524D\u9009\u4E2D\u7684\u89D2\u8272\u5417",onOk(){u({type:"common/getRequestData",method:"post",url:"/data-acquisition/role-info/removeBatch",payload:{ids:x},callback:e=>{e.success&&R()}})},onCancel(){console.log("Cancel")}})},G=()=>{let e="",a={};o.id?(e="/data-acquisition/role-info/update",a=d(n({},o),{jurisdictionDeadline:o.jurisdictionDeadline===null?"":o.jurisdictionDeadline.format("YYYY-MM-DD HH:mm:SS")})):(e="/data-acquisition/role-info/create",a=d(n({},o),{jurisdictionDeadline:o.jurisdictionDeadline===null?"":o.jurisdictionDeadline.format("YYYY-MM-DD HH:mm:SS")})),u({type:"common/getRequestData",method:"post",url:e,payload:n({},a),callback:l=>{console.log(l),l.success&&(N(!1),R())}})},pe=(e,a)=>{console.log("selected",e,a)},he=(e,a)=>{console.log("onCheck",e,a),g(d(n({},o),{pageAuthority:e?JSON.stringify(e):""}))},q=e=>{g(e),u({type:"common/getRequestData",method:"GET",url:"/data-acquisition/user-info/findByRoleId?roleId="+e.id,payload:{},callback:a=>{if(a.success){const l=a.data;console.log(l),O(!0),re("\u7528\u6237\u6210\u5458"),le(l)}}})},Ee=()=>{U(),F({}),M("\u65B0\u589E\u7528\u6237"),B(!0)},ye=e=>{U(),F(n({},e)),M("\u7F16\u8F91\u7528\u6237"),B(!0)},fe=e=>{S.confirm({title:"\u5220\u9664",icon:"",content:"\u786E\u5B9A\u8981\u5220\u9664\u5F53\u524D\u89D2\u8272\u5417",onOk(){u({type:"common/getRequestData",method:"delete",url:"/data-acquisition/user-info/"+e,payload:{},callback:a=>{a.success&&(B(!1),q(o))}})},onCancel(){console.log("Cancel")}})},ge=()=>{let e="",a={};p.id?(e="/data-acquisition/user-info/update",a=n({},p)):(e="/data-acquisition/user-info/create",a=n({},p)),u({type:"common/getRequestData",method:"post",url:e,payload:n({},a),callback:l=>{console.log(l),l.success&&(B(!1),q(o))}})};return t.createElement("div",{className:c.jurisdictionManage},t.createElement("div",{className:c.search},t.createElement("div",{className:c.left},t.createElement(I,{onClick:()=>{ie()},type:"primary",icon:t.createElement(J,null)},"\u65B0\u589E\u89D2\u8272"),t.createElement(I,{onClick:()=>{Ee()},type:"primary",icon:t.createElement(J,null)},"\u65B0\u589E\u7528\u6237"),t.createElement(I,{onClick:()=>{me()},type:"primary",icon:t.createElement(Ae,null),danger:!0},"\u6279\u91CF\u5220\u9664")),t.createElement("div",{className:c.right})),t.createElement(T,d(n({rowKey:"id",scroll:{x:1e3}},Y),{rowSelection:{type:"checkbox",columnWidth:"5%",selectedRowKeys:x,onChange:e=>{k(e)}}}),f.tableColumns?f.tableColumns(i,Y).map((e,a)=>t.createElement(_,d(n({key:a},e),{onCell:()=>({width:e.width}),onHeaderCell:()=>({width:e.width})}))):null,t.createElement(_,{width:"10%",align:"center",title:"\u505C\u7528/\u542F\u7528",render:(e,a,l)=>t.createElement(Ne,{checkedChildren:"\u5F00\u542F",unCheckedChildren:"\u505C\u7528",defaultChecked:a.status===1,onChange:r=>{console.log(r),g(d(n({},o),{status:r?1:0})),G()}})}),f.operation&&!!f.operation.length?t.createElement(_,{title:"\u64CD\u4F5C",width:"10%",align:"center",fixed:"right",render:(e,a)=>t.createElement(z,null,!!f.operation.length&&f.operation.map((l,r)=>t.createElement("a",{key:r,onClick:()=>{D(a),l.name==="\u67E5\u770B\u7528\u6237"&&q(a),l.name==="\u7F16\u8F91"&&ce(a.id),l.name==="\u5220\u9664"&&de(a.id)}},l.name)))}):null),t.createElement(S,{title:te,visible:ae,onOk:()=>{ge()},onCancel:()=>{B(!1)},width:600,style:{borderRadius:"5%"}},t.createElement(h,{layout:"vertical"},t.createElement("div",{className:c["m-box"]},t.createElement("div",{className:c["mb-row2"]},t.createElement("div",{className:c["mbr-left"]},t.createElement(h.Item,{required:!0,label:"\u7528\u6237\u59D3\u540D"},t.createElement(v,{value:p.username,onChange:e=>{F(d(n({},p),{username:e.target?e.target.value:e}))},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u59D3\u540D"}))),t.createElement("div",{className:c["mbr-right"]},t.createElement(h.Item,{required:!0,label:"\u6240\u5C5E\u89D2\u8272"},t.createElement(Q,{value:p.roleId,onChange:e=>{F(d(n({},p),{roleId:e.target?e.target.value:e}))},style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u89D2\u8272"},$.map(e=>t.createElement(Me,{key:e.id,value:e.id},e.roleName)))))),t.createElement("div",{className:c["mb-row2"]},t.createElement("div",{className:c["mbr-left"]},t.createElement(h.Item,{required:!0,label:"\u624B\u673A\u53F7\u7801"},t.createElement(v,{value:p.phone,onChange:e=>{F(d(n({},p),{phone:e.target?e.target.value:e}))},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"}))),t.createElement("div",{className:c["mbr-right"]},t.createElement(h.Item,{required:!0,label:"\u7528\u6237\u5BC6\u7801"},t.createElement(v.Password,{value:p.password,onChange:e=>{F(d(n({},p),{password:e.target?e.target.value:e}))},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801"})))),t.createElement("div",{style:{color:"red"}},"\u89C4\u5219\uFF1A\u5BC6\u7801\u5FC5\u987B\u7531\u5927\u5199\u5B57\u6BCD\uFF0C\u5C0F\u5199\u5B57\u6BCD\uFF0C\u6570\u5B57\uFF0C\u7279\u6B8A\u5B57\u7B26\u7EC4\u6210,\u4E14\u957F\u5EA6\u5927\u4E8E8\u4F4D")))),t.createElement(S,{title:X,visible:Z,onOk:()=>{G()},onCancel:()=>{N(!1)},width:800,style:{borderRadius:"5%"}},t.createElement(h,{layout:"vertical"},t.createElement("div",{style:{display:"flex"}},t.createElement("div",{style:{flex:.7,marginRight:"20px"},className:c["m-box"]},t.createElement("div",{className:c["mb-row1"]},t.createElement(h.Item,{required:!0,label:"\u89D2\u8272\u540D\u79F0"},t.createElement(v,{value:o.roleName,onChange:e=>{g(d(n({},o),{roleName:e.target?e.target.value:e}))},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"}))),t.createElement("div",{className:c["mb-row1"]},t.createElement(h.Item,{required:!0,label:"\u64CD\u4F5C\u6743\u9650"},t.createElement(V.Group,{value:o.operationAuthority,onChange:e=>{g(d(n({},o),{operationAuthority:e.target?e.target.value:e}))}},(P=s==null?void 0:s.operation_authority)==null?void 0:P.map(e=>t.createElement(V,{key:e.typeCode,value:e.typeCode},e.typeName))))),t.createElement("div",{className:c["mb-row1"]},t.createElement(h.Item,{required:!0,label:"\u6743\u9650\u671F\u9650"},t.createElement(Re,{value:o.jurisdictionDeadline,showTime:!0,onChange:e=>{g(d(n({},o),{jurisdictionDeadline:e.target?e.target.value:e}))},style:{width:"100%"}})))),t.createElement("div",{style:{flex:1},className:c["m-box"]},t.createElement("div",{className:c["mb-row1"]},t.createElement(h.Item,{required:!0,label:"\u9875\u9762\u6743\u9650"},t.createElement(ve,{checkable:!0,defaultExpandedKeys:o.pageAuthority,defaultSelectedKeys:o.pageAuthority,defaultCheckedKeys:o.pageAuthority,onSelect:pe,onCheck:he,treeData:y}))))))),t.createElement(qe,{title:o.roleName+" \u4E0B\u7684\u7528\u6237",placement:"right",onClose:()=>{D({}),O(!1)},visible:oe,width:"60vw",zIndex:2},t.createElement("div",{className:c.detail},t.createElement(T,{rowKey:"channelId",dataSource:ue,pagination:!1},f.userTableColumns.map(e=>t.createElement(_,n({},e))),t.createElement(_,{width:"15%",title:"\u6240\u5C5E\u89D2\u8272",align:"center",render:(e,a,l)=>o.roleName}),t.createElement(_,{title:"\u64CD\u4F5C",align:"center",width:"10%",key:"action",render:(e,a)=>t.createElement(z,{size:"middle"},f.userOperation.map(l=>t.createElement("a",{onClick:()=>{l.name==="\u7F16\u8F91"&&ye(a),l.name==="\u5220\u9664"&&fe(a.id)}},l.name)))})))))};var tt=ke(({common:i,select:u})=>({common:i,select:u}))(Oe);export{tt as default};

var y=Object.defineProperty,N=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var U=(o,t,a)=>t in o?y(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a,c=(o,t)=>{for(var a in t||(t={}))V.call(t,a)&&U(o,a,t[a]);if(I)for(var a of I(t))_.call(t,a)&&U(o,a,t[a]);return o},f=(o,t)=>N(o,T(t));import{_ as n,A,a as v,c as B,R as d,B as R}from"./index.1744db00.js";import{s as S}from"./SearchMore.b58ad9fc.js";import{w as E}from"./index.2cf55c0b.js";import{G as $}from"./global.00e9e87c.js";import{A as D}from"./index.75524ced.js";import{F as M}from"./index.a10c21c4.js";import"./index.94ba65ab.js";import"./index.0b2062c9.js";import"./index.ba1b5373.js";import"./index.2f265e7d.js";import"./Table.e070c8af.js";import"./Pagination.88552979.js";import"./index.54246283.js";import"./index.4d18e0ae.js";import"./utils.e0cd641f.js";import"./DeleteOutlined.52ed62e0.js";var P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},H=P,L=function(t,a){return n.exports.createElement(A,v(v({},t),{},{ref:a,icon:H}))};L.displayName="UploadOutlined";var j=n.exports.forwardRef(L);const{rootUrl:F,rbacToken:b}=$,z=S(D)``,W=S.div`
  && {
    border: 1px solid #d9d9d9;
    padding: 1vh;
    height: 100%;
  }
`,G=o=>{const t=o.conf,{name:a}=o,[p,m]=n.exports.useState([]),[C,O]=n.exports.useState({}),[h,i]=n.exports.useState(),u=n.exports.useContext(E),k=function(l){let r=[];switch(typeof l){case"string":l==""?r=[]:r=l.split(",");break;case"object":r=l;break;default:r=[];break}return r===null?[]:r.length>0?r.map(function(e,g){return f(c({},e),{uid:e.fileId?e.fileId:e,fileId:e.fileId?e.fileId:"",name:e.fileName?e.fileName:"",status:"done",fileType:e.contentType?e.contentType:"",url:`${F}/fyHome/file/download?id=${e.fileId?e.fileId:e}&rbacToken=${b}`})}):r};return n.exports.useMemo(()=>{const l=u.form.getFieldValue(a),r=k(l);m(r),O({name:"file",action:F+t.uploadUrl,headers:{},data:{rbacToken:b},onRemove(e){},onChange(e){const g=u.form.getFieldValue(a);console.log(g);const w=e.fileList;let x=[];e.file.status==="uploading"&&i(e.file.status),e.file.status==="done"||e.file.status==="removed"?(console.log(e.fileList),e.fileList.map(s=>{x.push({fileName:s.fileName?s.fileName:s.response.data.fileName,fileId:s.fileId?s.fileId:s.response.data.fileId,fileUrl:s.fileUrl?s.fileUrl:s.response.data.fileUrl})}),u.form.setFieldsValue({[a]:x}),i("")):e.file.status==="error"&&i(""),m([...w])},progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,format:e=>`${parseFloat(e.toFixed(2))}%`}})},[]),d.createElement(E.Consumer,null,l=>d.createElement(M.Item,{name:a,rules:o.rules},d.createElement(W,null,d.createElement(z,f(c({},C),{fileList:p,maxCount:t.maxCount,accept:t.accept,disabled:l.state==="disabled"}),l.state=="edit"||l.state=="new"?d.createElement(R,{disabled:p.length===t.maxCount?!0:h==="uploading"},d.createElement(j,null)," ",h==="uploading"?"\u4E0A\u4F20\u4E2D":"\u70B9\u51FB\u4E0A\u4F20\u6587\u4EF6"):null))))};var ue=B(({})=>({}))(G);export{ue as default};

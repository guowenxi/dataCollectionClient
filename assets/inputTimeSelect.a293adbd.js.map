{"version":3,"file":"inputTimeSelect.a293adbd.js","sources":["../src/components/TableInfo/fieldFile/inputTimeSelect.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled, { ThemeProvider } from 'styled-components';\n\nimport {connect} from \"dva\";\nimport { InputNumber as AInputNumber } from 'antd';\nimport { DatePicker as ADatePicker } from 'antd';\nimport type { Iconf} from '../TableInfo';\nimport { wrapContext } from '../TableInfo';\nimport { ShowData } from './_css_comm';\nimport moment from 'moment';\nimport { Form } from 'antd';\n\nconst FlexBox = styled.div`\n  display: flex;\n  flex-flow: row nowrap;\n`;\nconst MInputNumber = styled(AInputNumber)`\n  .ant-input-number-input {\n    height: auto;\n    padding: 0 11px 0 0;\n  }\n  flex: 2;\n  && {\n    width: 100%;\n    padding: 1vh;\n  }\n`;\nconst MDatePicker = styled(ADatePicker)`\n  flex: 1;\n  && {\n    height: 100%;\n    padding: 1vh;\n  }\n`;\n\ninterface IconfInput extends Iconf {\n  placeholder?: string;\n}\ninterface Iinput {\n  dispatch: any;\n  conf: IconfInput;\n  name: string;\n  rules: any;\n}\n\nlet defaultValueData: number=0;\n\nconst Input: React.FC<Iinput> = (props) => {\n  const _: any = props.conf;\n  const {name} = props;\n  // const { dispatch } = props;\n  const {dispatch} = props\n  const [NOWDATE, setNOWDATE] = useState(moment(new Date(), 'YYYY/MM/DD'));\n\n\n\n  async function changeData(params: any) {\n    if (!params) params = 0;\n    const data = await dispatch({\n      type: 'common/requestData',\n      url: _.url,\n      method: 'GET',\n      payload: {\n        limitNum: params,\n        beginDate: moment().format('YYYY/MM/DD'),\n      },\n    });\n\n    setNOWDATE(moment(data));\n  }\n\n  /* 获取当前值 */\n  const getCurrentValue=(data: any)=>{\n   const value: any=data.getFieldValue(name);\n   defaultValueData=value;\n  }\n\n  useEffect(()=>{\n    if(defaultValueData!=undefined || defaultValueData!=null){\n      changeData(defaultValueData);\n    }\n  },[defaultValueData])\n\n\n  return (\n    <wrapContext.Consumer>\n      {(_data: any): any => {\n        switch (_data.state) {\n          case 'default':\n            return <ShowData>{_.defaultValue || '　'}</ShowData>;\n            break;\n          case 'edit':\n          case 'new':\n          case 'disabled':\n            return (\n              <FlexBox>\n                <Form.Item name={name} rules={props.rules}>\n                  <MInputNumber\n                    onChange={(e) => {\n                      changeData(e);\n                    }}\n                    style={_.style}\n                    disabled={_data.state === 'disabled'}\n                    placeholder={_.placeholder}\n                    size={_.size}\n                    min={0}\n                  />\n                </Form.Item>\n                <MDatePicker disabled value={NOWDATE} />\n                {getCurrentValue(_data.form)}\n              </FlexBox>\n            );\n            break;\n        }\n      }}\n    </wrapContext.Consumer>\n  );\n};\nexport default connect(({}) => ({}))(Input);\n"],"names":["FlexBox","styled","MInputNumber","AInputNumber","MDatePicker","ADatePicker","defaultValueData","Input","props","_","name","dispatch","NOWDATE","useState","moment","changeData","params","__async","data","setNOWDATE","getCurrentValue","useEffect","React","wrapContext","_data","ShowData","Form","e"],"mappings":"uoBAYA,MAAMA,EAAUC,EAAO;AAAA;AAAA;AAAA,EAIjBC,EAAeD,EAAOE,CAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWlCC,EAAcH,EAAOI,CAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBtC,IAAIC,EAAyB,EAE7B,MAAMC,EAA0BC,GAAW,CACzC,MAAMC,EAASD,EAAM,KACf,CAEA,KAAAE,CACA,EAAAF,EAIN,CACE,SAAAG,CAAsB,EAAAH,EAChB,CAAAI,GAAsB,EAAAC,EAAA,QAAA,SAAAC,EAAA,IAAA,KAAA,YAAA,CAAA,EAAA,SACpBC,EAAAC,EAAA,QAAAC,EAAA,0BACCD,EAAA,GAAA,MACCE,EAAA,MAAAP,EAAA,CACR,KAAS,qBAAA,IACGF,EAAA,IAAA,OACC,MACb,QAAA,CACD,SAAAO,EAEU,UAAAF,IAAY,OAAA,YAAA,CACzB,CAGA,CAAM,EACCK,EAAAL,EAAgBI,CAAA,CAAA,CACL,GAClB,MAAAE,EAAAF,GAAA,CAGKZ,EADSY,EAAA,cAAAR,CAAA,CAEV,EACFW,OAAAA,EAAAA,QAAAA,UAAA,IAAA,EACCf,GAAiB,MAAAA,GAAA,OAGpBS,EACGT,CAAA,CAEiB,EACP,CAAAA,CAAA,CAAA,EACKgB,EAAA,cAAAC,EAAA,SAAA,KAAYC,GAAA,CACpB,OAAAA,EAAA,WACG,UACA,OAAAF,EAAA,cAAAG,EAAA,KAAAhB,EAAA,cAAA,QAAA,MAEH,WAEe,qBAAyB,OACjCa,EAAA,cAAAtB,EAAA,KAAAsB,EAAA,cAAAI,EAAA,KAAA,CACC,KAAAhB,EACE,MAAAF,EAAW,KAAC,EACdc,EAAA,cAAApB,EAAA,CACA,SAASyB,GAAA,CACTZ,MAEA,MAAQN,EAAA,MACR,SAAKe,EAAA,QAAA,WAET,YACCf,EAAA,YAAY,KAAQA,EAAA,KAAC,IAAO,CAAS,CAAA,CACrC,EAAgBa,EAAM,cACzBlB,EAAA,CAEF,SAAA,GAAA,MAAAQ,CAGR,CAAA,EAAAQ,EAAAI,EAAA,IAAA,CAAA"}